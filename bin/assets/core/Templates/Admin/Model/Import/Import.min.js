jQuery(document).ready(function(p){var m=0,l=!1,d=[],a=[];p(document).on("click",".tiFyTemplatesImport-RowImport",function(t){if(t.preventDefault(),!l){l=!0,notices=[],o();var e=p(this).closest("tr");m=1,c(e)}}),p(document).on("click",".tiFyTemplatesImport-submit",function(t){if(t.preventDefault(),!l){l=!0,notices=[],o();var e=AjaxListTable.page.info();m=e.recordsDisplay,p("#tiFyTemplatesImport-ProgressBar").tiFyProgress("option",{value:0,max:m,show:!0,info:'<span style="color:#2980b9;">'+tiFyTemplatesAdminImport.prepare+"</span>",close:function(t,e){e.infos('<span style="color:#f1c40f;">'+tiFyTemplatesAdminImport.cancel+"</span>"),l=!1,p(document).on("tiFyTemplatesImport.complete",function(){e.close()})}}),e.page?AjaxListTable.page(0).draw("page"):AjaxListTable.draw(!1),p(document).on("draw.dt.tiFyTemplatesImport",function(t,e,a,o){var s=p(AjaxListTable.row(":eq(0)",{page:"current"}).node());c(s),p(this).unbind("draw.dt.tiFyTemplatesImport")})}});var o=function(){p('form[name="tiFyTemplatesImport-optionsForm"]').length&&(a=p('form[name="tiFyTemplatesImport-optionsForm"]').serialize())};p(document).on("draw.dt.tiFyTemplatesImportAppendResponse",function(t,e,a,o){AjaxListTable.rows().every(function(t,e,a){!function(t){var e=AjaxListTable.cell(t[0],0),a=p(e.node()),o=p(".tiFyTemplatesImport-RowImport",a).data("item_index_value");if(void 0!==d[o]){var s=d[o];p(".tiFyTemplatesImport-Result",a).hide(),s.success?p(".tiFyTemplatesImport-Result--success",a).show():p(".tiFyTemplatesImport-Result--error",a).show(),p(".tiFyTemplatesImport-Notices",a).html(s.messages.join("")).addClass("tiFyTemplatesImport-Notices--filled")}}(p(this))})}),p(document).on("mouseenter mouseleave",".tiFyTemplatesImport-RowImport",function(t){var e=p(this).closest("td");"mouseenter"===t.type?p(".tiFyTemplatesImport-Notices--filled",e).show():p(".tiFyTemplatesImport-Notices--filled",e).hide()});var c=function(s){if(m&&l){var t=p(".tiFyTemplatesImport-RowImport",s).data("item_index_key"),r=p(".tiFyTemplatesImport-RowImport",s).data("item_index_value"),n=!!s.is(":last-child"),e={};e[t]=r,(import_data=JSON.parse(decodeURIComponent(p("#ajaxImportData").val())))&&(e=p.extend(e,import_data)),(datatables_data=JSON.parse(decodeURIComponent(p("#ajaxDatatablesData").val())))&&(e=p.extend(e,datatables_data)),a&&(e=p.extend(e,{__import_options:a})),s.addClass("active"),p("td",s).each(function(){p(this).append('<div class="tdOverlay"/>')}),p.ajax({url:tify_ajaxurl,type:"POST",data:e,dataType:"json",success:function(t,e,a){var o=[];if(p.each(t.notices,function(a,t){p.each(t,function(t,e){e.message&&o.push('<span style="color:'+tiFyTemplatesAdminImport.notices[a].color+';display:block;">'+e.message+"</span>")})}),p("#tiFyTemplatesImport-ProgressBar").tiFyProgress("infos",o.join("")),p("#tiFyTemplatesImport-ProgressBar").tiFyProgress("increase"),d[r]={success:t.success,messages:o},!--m)return AjaxListTable.draw("page"),void p(document).on("draw.dt.tiFyTemplatesImport",function(t,e,a,o){p("#tiFyTemplatesImport-ProgressBar").tiFyProgress("close"),l=!1,c(0),p(this).unbind("draw.dt.tiFyTemplatesImport")});if(n){i=0;AjaxListTable.page("next").draw("page")}else{var i=s.next().index();AjaxListTable.draw("page")}p(document).on("draw.dt.tiFyTemplatesImport",function(t,e,a,o){var s=p(AjaxListTable.row(":eq("+i+")",{page:"current"}).node());c(s),p(this).unbind("draw.dt.tiFyTemplatesImport")})}})}else p(document).trigger("tiFyTemplatesImport.complete")}});